<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Unity - Scripting API: Network.useProxy</title><meta name="description" content="Develop once, publish everywhere! Unity is the ultimate tool for video game development, architectural visualizations, and interactive media installations - publish to the web, Windows, OS X, Wii, Xbox 360, and iPhone with many more platforms to come." /><meta name="author" content="Unity Technologies" /><link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico" /><link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png" /><link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png" /><script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2854981-1']);
  _gaq.push(['_setDomainName', 'unity3d.com']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script><script type="text/javascript" src="../StaticFiles/js/jquery.js">//jquery</script><script type="text/javascript" src="../StaticFiles/classList.js">//core</script><script type="text/javascript" src="../StaticFiles/js/core.js">//core</script><script type="text/javascript" src="../StaticFiles/js/suggest.js">//suggest</script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css" /><link rel="stylesheet" type="text/css" href="../StaticFiles/css/suggest.css" /><!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="../StaticFiles/css/ie.css" /><![endif]--><!--[if lte IE 7]><link rel="stylesheet" type="text/css" href="../StaticFiles/css/ie7.css" /><![endif]--></head><body><div class="header-wrapper"><div id="header" class="header"><div class="content"><div class="logo"><a href="http://docs.unity3d.com" /></div><ul class="docs-menu"><li><a href="http://docs.unity3d.com">Overview</a></li><li><a href="../Manual/index.html">Manual</a></li><li><a href="../ScriptReference/index.html" class="selected">Scripting API</a></li></ul><div class="more-menu"><div class="box"><div class="label"><a href="http://unity3d.com/learn">Learn</a></div><ul style="display:none;"><li><a href="http://unity3d.com/learn/tutorials/modules">Tutorials</a></li><li><a href="http://unity3d.com/learn/live-training/">Live Training</a></li><li><a href="http://unity3d.com/learn/premium-support">Premium Support</a></li></ul></div><div class="box"><div class="label"><a href="http://unity3d.com/community">Community</a></div><ul style="display:none;"><li><a href="http://forum.unity3d.com/">Forums</a></li><li><a href="http://answers.unity3d.com/">Answers</a></li><li><a href="http://feedback.unity3d.com/">Feedback</a></li><li><a href="http://issuetracker.unity3d.com/">Issue Tracker</a></li></ul></div></div><div class="search"><form action="30_search.html" method="get" class="apisearch"><input type="text" name="q" placeholder="Search" autosave="Unity Reference" results="5" class="sbox field" id="q" /><input type="submit" class="submit" /></form></div></div></div><div class="toolbar"><div class="content"><div class="script-lang"><h4>Script language:</h4><ul><li class="selected" data-lang="JS">JS</li><li data-lang="CS">C#</li><li data-lang="Boo">Boo</li></ul><div id="script-lang-dialog" class="dialog hide"><div class="dialog-header clear"><h5>Script language</h5><div class="close"> </div></div><p>Select your preferred scripting language. All code snippets will be displayed in this language.</p></div></div></div><a class="suggest">Suggest a change</a></div></div><div id="master-wrapper" class="master-wrapper clear"><div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="ruler-t"> </div><div class="ruler-m"> </div><div class="ruler-b"> </div><div class="content"><div class="sidebar-menu"><h2>Scripting API</h2><div class="toc"> </div></div><p><a href="40_history.html" class="cl">History</a></p></div></div></div><div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content"><div class="section"><div class="mb20 clear"><h1 class="heading inherit left"><a href="Network.html">Network</a>.useProxy</h1><div class="clear"> </div></div><div class="subsection"><div class="signature"><div class="signature-JS sig-block">public static
      var <span class="sig-kw">useProxy</span>: bool;
     </div><div class="signature-CS sig-block">public static bool <span class="sig-kw">useProxy</span>;
     </div><div class="signature-Boo sig-block">public static <span class="sig-kw">useProxy</span> as bool </div></div></div><div class="subsection"><h2>Description</h2><p>Indicate if proxy support is needed, in which case traffic is relayed through the proxy server.</p></div><div class="subsection"><p>The proxy server is a solution to connectivity problems with servers
as well as clients. When a machine has an non NAT punchthrough capable
router his connectivity options are limited. A game cannot be hosted
as nobody external can connect to him (only clients on the local network can).
By using the proxy server the machine can be fully connectable but with
the extra cost of having all traffic relayed through another server.
A non NAT punchthrough capable client can connect to any server through 
the proxy server, as long as the proxy server is set up properly.<p class="basic" />Unity Technologies does not provide a proxy server for public use, so to
use this feature you will need to set up your own proxy server. Of course
it is advisable to set up a proxy server with a public IP address and
a lot of available bandwidth.<p class="basic" />When running as a client, just enabling Network.useProxy is all you have
to do. Connect to the server as usual with Network.Connect(). All traffic 
will be relayed through the proxy server. The servers external IP and internal
IP still work as usual. So clients can connect to him directly without
the proxy in case they are located on the same network.<p class="basic" />When running as a server OnServerInitialized(NetworkPlayer) returns a
NetworkPlayer structure which indicates what the game servers relayed
IP/port is, i.e. what port the proxy server allocated to the game server. 
This is the IP/port others can use to connect to. When connecting to the
server, the clients don't treat the server any differently than other servers.
Technically speaking, they don't need to know at all that the game server
is getting help from a proxy server. <p class="basic" />When using the master server you can no longer only rely on the IP/port he
registers for servers when using proxy support. The proxy server IP address
and port which the server is using can be placed in the comment field of
the data sent to the master server. A client which received host information
from the master server can peek into the comment field and find out if
he can use an alternative IP/port for that host.<p class="basic" />IMPORTANT: You should never enable proxy support for both the server and
the client connecting to him. Unexpected things are bound to happen.</p></div><div class="subsection">
      <pre class="codeExampleJS">	var imaserver: boolean;
	var serverIP: <a href="String.html">String</a>;
	var serverPort: int;
	var serverUsesNAT: boolean;
	
	function Awake() {
		// Set custom proxy server address
		<a href="Network-proxyIP.html">Network.proxyIP</a> = "1.1.1.1";
		<a href="Network-proxyPort.html">Network.proxyPort</a> = 1111;
	
		if (imaserver)
			StartServerWithProxy();
		else
			ConnectToServerWithProxy();
	}
	
	function StartServerWithProxy() {
		<a href="Network-useProxy.html">Network.useProxy</a> = true;
		<a href="Network.InitializeServer.html">Network.InitializeServer</a>(2,25000, false);
	}
	
	function OnServerInitialized(player: <a href="NetworkPlayer.html">NetworkPlayer</a>) {
		if (<a href="Network-useProxy.html">Network.useProxy</a>)
			<a href="Debug.Log.html">Debug.Log</a> ("Successfully started server with proxy support. We are connectable through "
				+ player.ipAddress + ":" + player.port);
	}<p class="basic" />	function OnFailedToConnect(msg: <a href="NetworkConnectionError.html">NetworkConnectionError</a>) {
		if (<a href="Network-useProxy.html">Network.useProxy</a> &amp;&amp; imaserver) {
			<a href="Debug.LogError.html">Debug.LogError</a>("Failed to connect to proxy server: " + msg);
		}
	}<p class="basic" />	function ConnectToServerWithProxy() {
		<a href="Network-useProxy.html">Network.useProxy</a> = true;
		<a href="Network.Connect.html">Network.Connect</a>(serverIP, serverPort);
	}<p class="basic" />	function OnConnectedToServer() {
		<a href="Debug.Log.html">Debug.Log</a>("Connected successfully to server");
	}
</pre>
      <pre class="codeExampleCS">using UnityEngine;
using System.Collections;

public class ExampleClass : <a href="MonoBehaviour.html">MonoBehaviour</a> {
    public bool imaserver;
    public string serverIP;
    public int serverPort;
    public bool serverUsesNAT;
    void Awake() {
        <a href="Network-proxyIP.html">Network.proxyIP</a> = "1.1.1.1";
        <a href="Network-proxyPort.html">Network.proxyPort</a> = 1111;
        if (imaserver)
            StartServerWithProxy();
        else
            ConnectToServerWithProxy();
    }
    void StartServerWithProxy() {
        <a href="Network-useProxy.html">Network.useProxy</a> = true;
        <a href="Network.InitializeServer.html">Network.InitializeServer</a>(2, 25000, false);
    }
    void OnServerInitialized(<a href="NetworkPlayer.html">NetworkPlayer</a> player) {
        if (<a href="Network-useProxy.html">Network.useProxy</a>)
            <a href="Debug.Log.html">Debug.Log</a>("Successfully started server with proxy support. We are connectable through " + player.ipAddress + ":" + player.port);
        
    }
    void OnFailedToConnect(<a href="NetworkConnectionError.html">NetworkConnectionError</a> msg) {
        if (<a href="Network-useProxy.html">Network.useProxy</a> &amp;&amp; imaserver)
            <a href="Debug.LogError.html">Debug.LogError</a>("Failed to connect to proxy server: " + msg);
        
    }
    void ConnectToServerWithProxy() {
        <a href="Network-useProxy.html">Network.useProxy</a> = true;
        <a href="Network.Connect.html">Network.Connect</a>(serverIP, serverPort);
    }
    void OnConnectedToServer() {
        <a href="Debug.Log.html">Debug.Log</a>("Connected successfully to server");
    }
}
</pre>
      <pre class="codeExampleBoo">import UnityEngine
import System.Collections

public class ExampleClass(<a href="MonoBehaviour.html">MonoBehaviour</a>):

	public imaserver as bool

	public serverIP as string

	public serverPort as int

	public serverUsesNAT as bool

	def Awake() as void:
		<a href="Network-proxyIP.html">Network.proxyIP</a> = '1.1.1.1'
		<a href="Network-proxyPort.html">Network.proxyPort</a> = 1111
		if imaserver:
			StartServerWithProxy()
		else:
			ConnectToServerWithProxy()

	def StartServerWithProxy() as void:
		<a href="Network-useProxy.html">Network.useProxy</a> = true
		<a href="Network.InitializeServer.html">Network.InitializeServer</a>(2, 25000, false)

	def OnServerInitialized(player as <a href="NetworkPlayer.html">NetworkPlayer</a>) as void:
		if <a href="Network-useProxy.html">Network.useProxy</a>:
			<a href="Debug.Log.html">Debug.Log</a>(((('Successfully started server with proxy support. We are connectable through ' + player.ipAddress) + ':') + player.port))

	def OnFailedToConnect(msg as <a href="NetworkConnectionError.html">NetworkConnectionError</a>) as void:
		if <a href="Network-useProxy.html">Network.useProxy</a> and imaserver:
			<a href="Debug.LogError.html">Debug.LogError</a>(('Failed to connect to proxy server: ' + msg))

	def ConnectToServerWithProxy() as void:
		<a href="Network-useProxy.html">Network.useProxy</a> = true
		<a href="Network.Connect.html">Network.Connect</a>(serverIP, serverPort)

	def OnConnectedToServer() as void:
		<a href="Debug.Log.html">Debug.Log</a>('Connected successfully to server')

</pre>
    </div></div></div></div></div></div><div class="footer-wrapper"><div class="footer clear"><div class="copy">Copyright © 2014 Unity Technologies</div><div class="menu"><a href="http://unity3d.com/unity">Unity</a><a href="http://unity3d.com/gallery">Gallery</a><a href="http://unity3d.com/asset-store">Asset Store</a><a href="https://store.unity3d.com">Buy</a><a href="http://unity3d.com/unity/download">Download</a></div></div></div><div class="suggestform_background"><div class="suggestform"><div class="suggestline"><div class="suggestlabel">Your name (optional):</div></div><div class="suggestline"><input id="suggest_username" type="text" /></div><div class="suggestline"><div class="suggestlabel">Your email (optional):</div></div><div class="suggestline"><input id="suggest_useremail" type="text" /></div>
	Please write your suggestion here:
	<div class="suggestline"><textarea id="suggest_body"> </textarea></div><div class="suggestline"><button id="suggest_submit">Submit</button><button id="suggest_cancel">Cancel</button></div></div></div><script type="text/javascript">
suggest_form();
</script></body></html>