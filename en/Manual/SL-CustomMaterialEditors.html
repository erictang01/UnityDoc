<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Custom Material Editors</title>
<meta name="description" content="Develop once, publish everywhere! Unity is the ultimate tool for video game development, architectural visualizations, and interactive media installations - publish to the web, Windows, OS X, Wii, Xbox 360, and iPhone with many more platforms to come.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2854981-1']);
  _gaq.push(['_setDomainName', 'unity3d.com']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js"></script><script type="text/javascript" src="../StaticFilesManual/js/highlight.js"></script><script type="text/javascript" src="../StaticFilesManual/js/toc_en.js"></script><script>hljs.initHighlightingOnLoad();</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css">
</head>
<body>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="http://docs.unity3d.com">Overview</a></li>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="http://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content"><div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/SL-CustomMaterialEditors.html">English</a></li>
<li><a href="/es/current/Manual/SL-CustomMaterialEditors.html">Español</a></li>
<li><a href="/ru/current/Manual/SL-CustomMaterialEditors.html">Русский</a></li>
</ul></div>
</div></div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManualRestructured.html">Unity Manual</a></li>
<li><a href="Graphics.html">Graphics</a></li>
<li><a href="GraphicsReference.html">Graphics Reference</a></li>
<li><a href="SL-Reference.html">Shader Reference</a></li>
<li><a href="SL-AdvancedTopics.html">Advanced ShaderLab topics</a></li>
<li>Custom Material Editors</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-ShaderReplacement.html"></a></span><div class="tip">Rendering with Replaced Shaders</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="SL-DepthTextures.html"></a></span><div class="tip">Using Depth Textures</div>
</div>
</div></div>
<h1>Custom Material Editors</h1>
  		        <div class="suggest">
                <a class="blue-btn sbtn">Suggest a change</a>
                <div class="suggest-wrap rel hide">
                  <div class="loading hide">
<div></div>
<div></div>
<div></div>
</div>
                  <div class="suggest-success hide">
                    <h2>Success!</h2>
                    <p>Thank you for helping us improve the quality of Unity Documentation. Although we cannot accept all submissions, we do read each suggested change from our users and will make updates where applicable.</p>
                    <a class="gray-btn sbtn close">Close</a>
                  </div>
                  <div class="suggest-failed hide">
                    <h2>Sumbission failed</h2>
                    <p>For some reason your suggested change could not be submitted. Please <a>try again</a> in a few minutes. And thank you for taking the time to help us improve the quality of Unity Documentation.</p>
                    <a class="gray-btn sbtn close">Close</a>
                  </div>
                  <div class="suggest-form clear">
                    <label for="suggest_name">Your name</label>
                    <input id="suggest_name" type="text">
                    <label for="suggest_email">Your email</label>
                    <input id="suggest_email" type="email">
                    <label for="suggest_body" class="clear">Suggestion <span class="r">*</span></label>
                    <textarea id="suggest_body" class="req"></textarea>
                    <button id="suggest_submit" class="blue-btn mr10">Submit suggestion</button>
                    <p class="mb0"><a class="cancel left lh42 cn">Cancel</a></p>
                  </div>
                </div>
              </div>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Sometimes you have a shader with some interesting data types that can not be nicely represented using the built in Unity material editor. Unity provides a way to override the default material inspector so that you can define your own. You can use this feature to define custom controls and data range validation.</p>

<p>The fist part to writing a custom material editor is defining a shader that requires a <a href="SL-CustomEditor.html">Custom Editor</a>. The name you use for the custom editor is the class that will be looked up by Unity for the material editor.</p>

<p>To define a custom editor you extend from the MaterialEditor class and place the script below an Editor folder in the assets directory.</p>

<pre><code>using UnityEditor;

public class CustomMaterialInspector : MaterialEditor {
    public override void OnInspectorGUI () {
        base.OnInspectorGUI ();
    }
}
</code></pre>

<p>Any shader that has a custom editor defined (<strong>CustomEditor “CustomMaterialInspector”</strong>) will find the editor listed above and execute the associated code. </p>

<h2>A real example</h2>

<p>So we have a situation where we have a shader that can work in two modes; it renders standard diffuse lighting or it only renders the red components of the source texture. This is achieved using <a href="SL-MultipleProgramVariants.html">shader multi compilation</a>.</p>

<pre><code>Shader &quot;Custom/Redify&quot; {
    Properties {
        _MainTex (&quot;Base (RGB)&quot;, 2D) = &quot;white&quot; {}
    }
    SubShader {
        Tags { &quot;RenderType&quot;=&quot;Opaque&quot; }
        LOD 200
        
        CGPROGRAM
        #pragma surface surf Lambert
        #pragma multi_compile REDIFY_ON REDIFY_OFF

        sampler2D _MainTex;

        struct Input {
            float2 uv_MainTex;
        };

        void surf (Input IN, inout SurfaceOutput o) {
            half4 c = tex2D (_MainTex, IN.uv_MainTex);
            o.Albedo = c.rgb;
            o.Alpha = c.a;


    #if REDIFY_ON
            o.Albedo.gb = (o.Albedo.g + o.Albedo.b) / 2.0;

    #endif
        }
        ENDCG
    } 
    FallBack &quot;Diffuse&quot;
    CustomEditor &quot;CustomMaterialInspector&quot;
}
</code></pre>

<p>As you can see the shader has two Keywords available for setting: REDIFY_ON and REDIFY_OFF. These can be changed be set on a per material basis by using the shaderKeywords property of the material. below is an editor that does this.</p>

<pre><code>using System.Collections.Generic;
using UnityEngine;
using UnityEditor;
using System.Linq;

public class CustomMaterialInspector : MaterialEditor {

    public override void OnInspectorGUI ()
    {
        // render the default inspector
        base.OnInspectorGUI ();

        // if we are not visible... return
        if (!isVisible)
            return;

        // get the current keywords from the material
        Material targetMat = target as Material;
        string[] keyWords = targetMat.shaderKeywords;

        // see if redify is set, then show a checkbox
        bool redify = keyWords.Contains (&quot;REDIFY_ON&quot;);
        EditorGUI.BeginChangeCheck();
        redify = EditorGUILayout.Toggle (&quot;Redify material&quot;, redify);
        if (EditorGUI.EndChangeCheck())
        {
            // if the checkbox is changed, reset the shader keywords
            var keywords = new List&lt;string&gt; { redify ? &quot;REDIFY_ON&quot; : &quot;REDIFY_OFF&quot;};
            targetMat.shaderKeywords = keywords.ToArray ();
            EditorUtility.SetDirty (targetMat);
        }
    }
}
</code></pre>

<h2>How the default material editor works</h2>

<p>The default Unity editor renders all the properties that exist in a shader to the the material editor. Below is a custom material editor that behaves similar to the Unity material editor. Use this example if you wish to manually render the default fields.</p>

<pre><code>using System.Collections.Generic;
using UnityEngine;
using UnityEditor;
using System.Linq;

public class CustomMatInspector : MaterialEditor {

    // this is the same as the ShaderProperty function, show here so 
    // you can see how it works
    private void ShaderPropertyImpl(Shader shader, int propertyIndex)
    {
        int i = propertyIndex;
        string label = ShaderUtil.GetPropertyDescription(shader, i);
        string propertyName = ShaderUtil.GetPropertyName(shader, i);
        switch (ShaderUtil.GetPropertyType(shader, i))
        {
            case ShaderUtil.ShaderPropertyType.Range: // float ranges
            {
                GUILayout.BeginHorizontal();
                float v2 = ShaderUtil.GetRangeLimits(shader, i, 1);
                float v3 = ShaderUtil.GetRangeLimits(shader, i, 2);
                RangeProperty(propertyName, label, v2, v3);
                GUILayout.EndHorizontal();

                break;
            }
            case ShaderUtil.ShaderPropertyType.Float: // floats
            {
                FloatProperty(propertyName, label);
                break;
            }
            case ShaderUtil.ShaderPropertyType.Color: // colors
            {
                ColorProperty(propertyName, label);
                break;
            }
            case ShaderUtil.ShaderPropertyType.TexEnv: // textures
            {
                ShaderUtil.ShaderPropertyTexDim desiredTexdim = ShaderUtil.GetTexDim(shader, i);
                TextureProperty(propertyName, label, desiredTexdim);

                GUILayout.Space(6);
                break;
            }
            case ShaderUtil.ShaderPropertyType.Vector: // vectors
            {
                VectorProperty(propertyName, label);
                break;
            }
            default:
            {
                GUILayout.Label(&quot;ARGH&quot; + label + &quot; : &quot; + ShaderUtil.GetPropertyType(shader, i));
                break;
            }
        }
    }

    public override void OnInspectorGUI ()
    {
        serializedObject.Update ();
        var theShader = serializedObject.FindProperty (&quot;m_Shader&quot;); 
        if (isVisible &amp;&amp; !theShader.hasMultipleDifferentValues &amp;&amp; theShader.objectReferenceValue != null)
        {
            float controlSize = 64;

            EditorGUIUtility.LookLikeControls(Screen.width - controlSize - 20);

            EditorGUI.BeginChangeCheck();
            Shader shader = theShader.objectReferenceValue as Shader;

            for (int i = 0; i &lt; ShaderUtil.GetPropertyCount(shader); i++)
            {
                ShaderPropertyImpl(shader, i);
            }

            if (EditorGUI.EndChangeCheck())
                PropertiesChanged ();
        }
    }
}
</code></pre>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-ShaderReplacement.html"></a></span><div class="tip">Rendering with Replaced Shaders</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="SL-DepthTextures.html"></a></span><div class="tip">Using Depth Textures</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2014 Unity Technologies</div>
<div class="menu">
<a href="http://unity3d.com/learn">Learn</a><a href="http://unity3d.com/community">Community</a><a href="http://unity3d.com/asset-store">Asset Store</a><a href="https://store.unity3d.com">Buy</a><a href="http://unity3d.com/unity/download">Download</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
